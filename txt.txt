function transformRecommendations(recommendations: { title: string; description: string }[]) {
  return recommendations.map((rec, index) => ({
    id: index + 1,
    movieTitle: rec.title,
  }));
}

async function fetchMoviePosters(transformedRecommendations: { id: number; movieTitle: string }[]) {
  try {
    const response = await fetch('/api/getMovieImages', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify(transformedRecommendations),
    });

    if (!response.ok) throw new Error('Failed to fetch movie posters.');

    const movieImageLinks = await response.json();

    // Merge the images back into the recommendations
    return transformedRecommendations.map((rec) => ({
      ...rec,
      imageUrl: movieImageLinks[rec.id] || null,
    }));
  } catch (error) {
    console.error('Error fetching movie posters:', error);
    return transformedRecommendations.map((rec) => ({
      ...rec,
      imageUrl: null,
    }));
  }
}